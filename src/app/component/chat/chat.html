<div class="card bg-body bg-opacity-75" style="height: 78dvh">
  <!-- En-tête -->
  <div class="card-header">
    <h2 class="pb-2 d-flex align-items-center">
      <i class="fa fa-commenting me-1" aria-hidden="true"></i>Chatbot Assistant
    </h2>
  </div>

  <!-- Zone des messages -->
  <div
    #messagesContainer
    class="flex-grow-1 overflow-auto p-3"
  >
    <div *ngFor="let message of messages" class="mb-3 d-flex"
         [class.justify-content-end]="message.isUser"
         [class.justify-content-start]="!message.isUser">
      <div class="card rounded-3 bg-opacity-75"
           [ngClass]="{
             'bg-primary text-white': message.isUser,
             'bg-body-secondary': !message.isUser
           }">
        <div class="card-body p-2">
          <p class="mb-1">{{ message.text }}</p>
          <small [ngClass]="{
             'text-white': message.isUser,
             'text-muted': !message.isUser
           }">
            {{ message.timestamp | date:'HH:mm' }}
          </small>
        </div>
      </div>
    </div>
  </div>

  <!-- Zone de saisie -->
  <div class="card-footer">
    <div class="input-group">
      <input
        [(ngModel)]="userMessage"
        (keyup.enter)="sendMessage()"
        placeholder="Écris un message..."
        [disabled]="isLoading"
        class="form-control"
      />
      <button
        (click)="sendMessage()"
        [disabled]="isLoading || !userMessage.trim()"
        class="btn"
        [ngClass]="{
          'btn-primary': !isLoading,
          'btn-light': isLoading
        }"
      >
        <ng-container *ngIf="!isLoading">Envoyer</ng-container>
        <ng-container *ngIf="isLoading">
          <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
          Envoi...
        </ng-container>
      </button>
    </div>
  </div>
</div>
